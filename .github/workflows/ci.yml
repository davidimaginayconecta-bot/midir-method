name: CI
on:
  push:
  pull_request:
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: conda-incubator/setup-miniconda@v3
        with:
          activate-environment: midir-method
          environment-file: env.yml
          auto-activate-base: false
      - name: Python info
        run: |
          python -V
          pip -V || true
      - name: Run tests
        shell: bash -l {0}
        run: |
          python - << 'PY'
import sys
print("Sanity import:")
import src.io.loader, src.sed.models, src.fit.bic, src.score.iwi, src.vetting.tree
print("OK")
PY
      - name: Run demo notebook (nbconvert)
        shell: bash -l {0}
        run: |
          python -m jupyter nbconvert --to notebook --execute --ExecutePreprocessor.timeout=600 --inplace notebooks/N00_demo_lite.ipynb
